{"ast":null,"code":"import React,{useState,useRef,useEffect}from'react';import{Upload,FileText,MapPin,Calendar,BarChart3,AlertCircle,CheckCircle,X,Eye}from'lucide-react';import{Link}from'react-router-dom';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const locations=[{id:'wichita',name:'Wichita Kenworth',code:'WIC',color:'from-blue-500 to-blue-600'},{id:'emporia',name:'Emporia Kenworth',code:'EMP',color:'from-green-500 to-green-600'},{id:'dodge-city',name:'Dodge City Kenworth',code:'DOD',color:'from-purple-500 to-purple-600'},{id:'liberal',name:'Liberal Kenworth',code:'LIB',color:'from-orange-500 to-orange-600'}];// Backend API base URL\nconst API_BASE_URL='https://wki-service-management-app.onrender.com';// Test API connection\nconst testAPIConnection=async()=>{try{// Test the main endpoint we'll be using\nconst response=await fetch(\"\".concat(API_BASE_URL,\"/api/locationMetrics/upload\"),{method:'GET'// Just test connectivity, not actual upload\n});console.log('Backend connectivity test:',response.status);if(response.status===405){// Method not allowed is expected for GET on upload endpoint\nconsole.log('✅ Backend is responding (POST endpoint ready)');return true;}else if(response.status===500){console.log('⚠️ Backend responding but has server errors (likely database issue)');return true;// Backend is running, just has DB issues\n}return response.ok;}catch(error){console.error('Backend connectivity test failed:',error instanceof Error?error.message:String(error));return false;}};// API functions\nconst uploadScorecardToAPI=async(file,month,year)=>{const formData=new FormData();formData.append('pdf',file);// Match your backend's expected field name\nformData.append('month',month);formData.append('year',year.toString());// We found the correct endpoint: /api/locationMetrics/upload\nconst apiUrl=\"\".concat(API_BASE_URL,\"/api/locationMetrics/upload\");console.log('Uploading to:',apiUrl);const response=await fetch(apiUrl,{method:'POST',body:formData});if(!response.ok){const errorText=await response.text();console.error('Upload failed:',response.status,errorText);// Handle specific backend errors\nif(response.status===500&&errorText.includes('buffering timed out')){throw new Error('Database connection timeout. Please try again in a moment - the backend database may be starting up.');}else if(response.status===500){throw new Error('Server error. Please check backend logs for details.');}throw new Error(\"Upload failed: \".concat(response.status,\" \").concat(response.statusText,\" - \").concat(errorText));}return response.json();};const fetchLocationMetrics=async()=>{const response=await fetch(\"\".concat(API_BASE_URL,\"/api/locationMetrics\"));if(!response.ok){throw new Error(\"Failed to fetch metrics: \".concat(response.statusText));}return response.json();};// This would be replaced with actual localStorage or database storage\nconst getStoredScorecards=()=>{const stored=localStorage.getItem('wki-scorecards');return stored?JSON.parse(stored):[];};const saveStoredScorecards=scorecards=>{localStorage.setItem('wki-scorecards',JSON.stringify(scorecards));};const getStoredDealershipData=()=>{const stored=localStorage.getItem('wki-dealership-scorecards');return stored?JSON.parse(stored):[];};const saveStoredDealershipData=dealershipData=>{localStorage.setItem('wki-dealership-scorecards',JSON.stringify(dealershipData));};export default function ScorecardManager(){const[scorecards,setScorecards]=useState([]);const[dealershipData,setDealershipData]=useState([]);const[isUploading,setIsUploading]=useState(false);const[uploadProgress,setUploadProgress]=useState(0);const[selectedMonth,setSelectedMonth]=useState('');const[selectedYear,setSelectedYear]=useState(new Date().getFullYear());const[dragActive,setDragActive]=useState(false);const[parseError,setParseError]=useState(null);const[isLoading,setIsLoading]=useState(true);const fileInputRef=useRef(null);// Always load data from backend on mount, fallback to localStorage if backend fails\nuseEffect(()=>{const loadData=async()=>{try{// Test API connection\nconst apiWorking=await testAPIConnection();console.log('API connection test result:',apiWorking);// Always try to fetch from backend\nconst backendData=await fetchLocationMetrics();// Parse backendData for dealership and locations\nlet dealership,locations,extractedAt;if(backendData&&typeof backendData==='object'){if('dealership'in backendData&&'locations'in backendData){({dealership,locations,extractedAt}=backendData);}else if('data'in backendData&&backendData.data&&typeof backendData.data==='object'){if('dealership'in backendData.data&&'locations'in backendData.data){({dealership,locations,extractedAt}=backendData.data);}}}if(dealership&&locations){// Build scorecards from backend\nconst dealershipScorecard={id:\"dealership-latest\",month:'',year:0,fileName:'',uploadDate:new Date(extractedAt||new Date().toISOString()),metrics:dealership,locations:[]};const locationScorecards=locations.map(location=>{const locationInfo=getLocationInfo(location.name);return{id:\"\".concat(locationInfo.id,\"-latest\"),location:location.name,locationId:locationInfo.id,month:'',year:0,fileName:'',uploadDate:new Date(extractedAt||new Date().toISOString()),metrics:location,trend:calculateTrend()};});dealershipScorecard.locations=locationScorecards;setDealershipData([dealershipScorecard]);setScorecards(locationScorecards);}else{setScorecards([]);setDealershipData([]);}}catch(error){// Fallback to localStorage if backend fails\nconsole.error('Error loading data from backend, using localStorage fallback:',error);setScorecards(getStoredScorecards());setDealershipData(getStoredDealershipData());}finally{setIsLoading(false);}};loadData();},[]);// Generate months for dropdown\nconst months=['January','February','March','April','May','June','July','August','September','October','November','December'];// Generate years (current year and 2 previous years)\nconst years=Array.from({length:3},(_,i)=>new Date().getFullYear()-i);const handleFileUpload=async files=>{if(!files||files.length===0)return;if(!selectedMonth){alert('Please select a month before uploading');return;}const file=files[0];if(!file.name.toLowerCase().includes('.pdf')){alert('Please upload a PDF file');return;}setIsUploading(true);setUploadProgress(0);setParseError(null);try{// Upload to backend API\nsetUploadProgress(20);console.log('Starting upload process...');const result=await uploadScorecardToAPI(file,selectedMonth,selectedYear);console.log('Upload successful, result:',result);setUploadProgress(60);// DEBUGGING BLOCK - Add this to see what the backend is actually returning\nconsole.log('=== DEBUGGING RESPONSE STRUCTURE ===');console.log('Type of result:',typeof result);console.log('Result keys:',Object.keys(result||{}));console.log('Full result structure:',JSON.stringify(result,null,2));// Check specific properties\nconsole.log('Has dealership?','dealership'in(result||{}));console.log('Has locations?','locations'in(result||{}));console.log('Has data?','data'in(result||{}));if(result&&typeof result==='object'&&'data'in result){console.log('Data structure:',JSON.stringify(result.data,null,2));console.log('Data keys:',Object.keys(result.data||{}));}console.log('=== END DEBUG ===');// Process the returned data from your backend with flexible parsing\nconsole.log('Processing result structure:',result);let dealership,locations,extractedAt;if(result&&typeof result==='object'){// Pattern 1: Direct structure { dealership, locations, extractedAt }\nif('dealership'in result&&'locations'in result){({dealership,locations,extractedAt}=result);console.log('✅ Using Pattern 1: Direct structure');}// Pattern 2: Nested in data { success, data: { dealership, locations } }\nelse if('data'in result&&result.data&&typeof result.data==='object'){if('dealership'in result.data&&'locations'in result.data){({dealership,locations,extractedAt}=result.data);console.log('✅ Using Pattern 2: Nested in data');}}// Pattern 3: Success wrapper { success: true, dealership, locations }\nelse if('success'in result&&'dealership'in result&&'locations'in result){({dealership,locations,extractedAt}=result);console.log('✅ Using Pattern 3: Success wrapper');}// Pattern 4: Results wrapper { results: { dealership, locations } }\nelse if('results'in result&&result.results&&typeof result.results==='object'){if('dealership'in result.results&&'locations'in result.results){({dealership,locations,extractedAt}=result.results);console.log('✅ Using Pattern 4: Results wrapper');}}// Pattern 5: Message with data { message: \"success\", data: {...} }\nelse if('message'in result&&'data'in result&&result.data){if(typeof result.data==='object'&&'dealership'in result.data&&'locations'in result.data){({dealership,locations,extractedAt}=result.data);console.log('✅ Using Pattern 5: Message with data');}}// Pattern 6: Check if the result itself contains arrays/objects that might be locations\nelse if(Array.isArray(result)){console.log('⚠️  Response is an array, might be locations directly');locations=result;// You might need to extract dealership data differently\n}else{console.error('❌ Unknown response pattern. Available keys:',Object.keys(result));console.error('Full response:',JSON.stringify(result,null,2));}}// More detailed error handling\nif(!dealership&&!locations){const errorDetails=\"\\nResponse Analysis:\\n- Type: \".concat(typeof result,\"\\n- Keys: \").concat(result&&typeof result==='object'?Object.keys(result).join(', '):'N/A',\"\\n- Structure: \").concat(JSON.stringify(result,null,2),\"\\n\\nExpected one of these structures:\\n1. { dealership: {...}, locations: [...] }\\n2. { data: { dealership: {...}, locations: [...] } }\\n3. { success: true, dealership: {...}, locations: [...] }\\n4. { results: { dealership: {...}, locations: [...] } }\\n5. { message: \\\"...\\\", data: { dealership: {...}, locations: [...] } }\\n        \");throw new Error(\"Invalid response structure from backend. \".concat(errorDetails));}else if(!dealership){throw new Error(\"Missing dealership data in response. Available: \".concat(locations?'locations':'none'));}else if(!locations){throw new Error(\"Missing locations data in response. Available: \".concat(dealership?'dealership':'none'));}// Create dealership scorecard from backend response\nconst dealershipScorecard={id:\"dealership-\".concat(selectedMonth,\"-\").concat(selectedYear),month:selectedMonth,year:selectedYear,fileName:file.name,uploadDate:new Date(extractedAt||new Date().toISOString()),metrics:dealership,locations:[]};// Create location scorecards from backend response\nconst locationScorecards=locations.map(location=>{const locationInfo=getLocationInfo(location.name);return{id:\"\".concat(locationInfo.id,\"-\").concat(selectedMonth,\"-\").concat(selectedYear),location:location.name,locationId:locationInfo.id,month:selectedMonth,year:selectedYear,fileName:file.name,uploadDate:new Date(extractedAt||new Date().toISOString()),metrics:location,trend:calculateTrend()// Random trend for now\n};});dealershipScorecard.locations=locationScorecards;setUploadProgress(90);// After upload, always fetch latest from backend and update UI\nsetUploadProgress(100);try{const backendData=await fetchLocationMetrics();let dealership,locations,extractedAt;if(backendData&&typeof backendData==='object'){if('dealership'in backendData&&'locations'in backendData){({dealership,locations,extractedAt}=backendData);}else if('data'in backendData&&backendData.data&&typeof backendData.data==='object'){if('dealership'in backendData.data&&'locations'in backendData.data){({dealership,locations,extractedAt}=backendData.data);}}}if(dealership&&locations){const dealershipScorecard={id:\"dealership-latest\",month:'',year:0,fileName:'',uploadDate:new Date(extractedAt||new Date().toISOString()),metrics:dealership,locations:[]};const locationScorecards=locations.map(location=>{const locationInfo=getLocationInfo(location.name);return{id:\"\".concat(locationInfo.id,\"-latest\"),location:location.name,locationId:locationInfo.id,month:'',year:0,fileName:'',uploadDate:new Date(extractedAt||new Date().toISOString()),metrics:location,trend:calculateTrend()};});dealershipScorecard.locations=locationScorecards;setDealershipData([dealershipScorecard]);setScorecards(locationScorecards);}else{setScorecards([]);setDealershipData([]);}}catch(error){// Fallback to localStorage if backend fails\nconsole.error('Error fetching after upload, using localStorage fallback:',error);setScorecards(getStoredScorecards());setDealershipData(getStoredDealershipData());}setTimeout(()=>{setIsUploading(false);setUploadProgress(0);// Dispatch custom event to notify other components about new data\nwindow.dispatchEvent(new CustomEvent('scorecardUploaded',{detail:{dealership,locations,extractedAt,timestamp:new Date().getTime()}}));alert(\"Successfully uploaded and processed \".concat(file.name,\"!\\n\\nExtracted data for:\\n- WKI Dealership\\n- \").concat(locations?locations.length:0,\" locations\"));},500);}catch(error){console.error('Error uploading PDF:',error);const errorMessage=error instanceof Error?error.message:'Failed to process PDF. Please try again.';console.error('Detailed error:',errorMessage);setParseError(errorMessage);setIsUploading(false);setUploadProgress(0);}};// Helper function to get location info by name\nconst getLocationInfo=locationName=>{const normalized=locationName.toLowerCase();if(normalized.includes('wichita'))return locations[0];if(normalized.includes('emporia'))return locations[1];if(normalized.includes('dodge'))return locations[2];if(normalized.includes('liberal'))return locations[3];return{id:'unknown',name:locationName,code:'UNK',color:'from-gray-500 to-gray-600'};};// Helper function to calculate trend\nconst calculateTrend=()=>{// Random trend for now - in real implementation, compare with previous month\nconst trends=['up','down','stable'];return trends[Math.floor(Math.random()*trends.length)];};const handleDrag=e=>{e.preventDefault();e.stopPropagation();if(e.type==='dragenter'||e.type==='dragover'){setDragActive(true);}else if(e.type==='dragleave'){setDragActive(false);}};const handleDrop=e=>{e.preventDefault();e.stopPropagation();setDragActive(false);handleFileUpload(e.dataTransfer.files);};const deleteScorecard=id=>{setScorecards(prev=>{const updated=prev.filter(sc=>sc.id!==id);saveStoredScorecards(updated);// Save to localStorage\nreturn updated;});};const getLocationName=locationId=>{var _locations$find;return((_locations$find=locations.find(loc=>loc.id===locationId))===null||_locations$find===void 0?void 0:_locations$find.name)||locationId;};const getLocationColor=locationId=>{var _locations$find2;return((_locations$find2=locations.find(loc=>loc.id===locationId))===null||_locations$find2===void 0?void 0:_locations$find2.color)||'from-slate-500 to-slate-600';};return/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-7xl mx-auto px-4 py-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-center mb-8\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-4xl font-bold bg-gradient-to-r from-red-600 to-red-700 bg-clip-text text-transparent mb-4\",children:\"Monthly Service Scorecard Manager\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xl text-slate-300 mb-4\",children:\"Upload and manage monthly W370 Service Scorecards for all WKI locations\"}),/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-center\",children:/*#__PURE__*/_jsxs(Link,{to:\"/location-metrics\",className:\"inline-flex items-center px-6 py-3 bg-gradient-to-r from-purple-600 to-purple-700 text-white font-medium rounded-lg hover:from-purple-700 hover:to-purple-800 transition-all duration-200 shadow-lg hover:shadow-purple-500/25\",children:[/*#__PURE__*/_jsx(Eye,{className:\"w-5 h-5 mr-2\"}),\"View Location Performance Dashboard\"]})})]}),isLoading?/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-center py-12\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin w-12 h-12 border-4 border-red-500 border-t-transparent rounded-full\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-slate-300 ml-4\",children:\"Loading scorecard data...\"})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gradient-to-br from-slate-800 via-slate-900 to-slate-800 rounded-2xl p-8 mb-8 border border-slate-700 shadow-2xl\",children:[/*#__PURE__*/_jsxs(\"h2\",{className:\"text-2xl font-bold text-white mb-6 flex items-center\",children:[/*#__PURE__*/_jsx(Upload,{className:\"w-6 h-6 mr-2 text-red-400\"}),\"Upload New Scorecard\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid md:grid-cols-2 gap-4 mb-6\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-slate-300 mb-2\",children:\"Month\"}),/*#__PURE__*/_jsxs(\"select\",{value:selectedMonth,onChange:e=>setSelectedMonth(e.target.value),className:\"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-red-500 focus:border-transparent\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select Month\"}),months.map(month=>/*#__PURE__*/_jsx(\"option\",{value:month,children:month},month))]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-slate-300 mb-2\",children:\"Year\"}),/*#__PURE__*/_jsx(\"select\",{value:selectedYear,onChange:e=>setSelectedYear(parseInt(e.target.value)),className:\"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-red-500 focus:border-transparent\",children:years.map(year=>/*#__PURE__*/_jsx(\"option\",{value:year,children:year},year))})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"border-2 border-dashed rounded-lg p-8 text-center transition-colors \".concat(dragActive?'border-red-400 bg-red-400/10':'border-slate-600 hover:border-red-400 hover:bg-red-400/5'),onDragEnter:handleDrag,onDragLeave:handleDrag,onDragOver:handleDrag,onDrop:handleDrop,children:[/*#__PURE__*/_jsx(\"input\",{ref:fileInputRef,type:\"file\",accept:\".pdf\",onChange:e=>handleFileUpload(e.target.files),className:\"hidden\"}),isUploading?/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin w-12 h-12 border-4 border-red-500 border-t-transparent rounded-full mx-auto\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-slate-300\",children:\"Processing scorecard...\"}),/*#__PURE__*/_jsx(\"div\",{className:\"w-full bg-slate-700 rounded-full h-2\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bg-red-500 h-2 rounded-full transition-all duration-300\",style:{width:\"\".concat(uploadProgress,\"%\")}})})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsx(FileText,{className:\"w-16 h-16 text-slate-400 mx-auto\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-white font-medium mb-2\",children:\"Drop your WKI Service Scorecard PDF here or click to browse\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-slate-400 text-sm\",children:\"Supports W370 Service Scorecard PDFs up to 10MB\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col sm:flex-row justify-center items-center gap-4\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{var _fileInputRef$current;return(_fileInputRef$current=fileInputRef.current)===null||_fileInputRef$current===void 0?void 0:_fileInputRef$current.click();},disabled:!selectedMonth,className:\"px-8 py-4 font-bold rounded-lg transition-all duration-200 transform hover:scale-105 shadow-lg \".concat(!selectedMonth?'bg-slate-600 text-slate-400 cursor-not-allowed':'bg-gradient-to-r from-red-600 to-red-700 text-white hover:from-red-700 hover:to-red-800 hover:shadow-red-500/25'),children:[/*#__PURE__*/_jsx(Upload,{className:\"w-5 h-5 mr-2 inline\"}),\"Choose Scorecard PDF\"]}),!selectedMonth&&/*#__PURE__*/_jsxs(\"div\",{className:\"text-yellow-400 text-sm flex items-center\",children:[/*#__PURE__*/_jsx(AlertCircle,{className:\"w-4 h-4 mr-1\"}),\"Please select month first\"]})]})]})]}),parseError&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-4 p-4 bg-red-900/50 border border-red-600 rounded-lg\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center text-red-300 mb-2\",children:[/*#__PURE__*/_jsx(AlertCircle,{className:\"w-5 h-5 mr-2\"}),/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:\"Upload Error\"})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-red-200 text-sm mb-2\",children:parseError}),parseError.includes('Database connection timeout')&&/*#__PURE__*/_jsx(\"div\",{className:\"mt-3 p-3 bg-yellow-900/30 border border-yellow-600 rounded\",children:/*#__PURE__*/_jsxs(\"p\",{className:\"text-yellow-200 text-sm\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Tip:\"}),\" This usually happens when the backend database is starting up. Wait 30-60 seconds and try uploading again.\"]})})]})]}),dealershipData.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gradient-to-br from-slate-800 via-slate-900 to-slate-800 rounded-2xl p-8 mb-8 border border-slate-700 shadow-2xl\",children:[/*#__PURE__*/_jsxs(\"h2\",{className:\"text-2xl font-bold text-white mb-6 flex items-center\",children:[/*#__PURE__*/_jsx(BarChart3,{className:\"w-6 h-6 mr-2 text-red-400\"}),\"Dealership Performance Summary\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"grid gap-4\",children:dealershipData.map(dealership=>/*#__PURE__*/_jsxs(\"div\",{className:\"bg-slate-800/50 rounded-lg p-6 border border-slate-700\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-12 h-12 bg-gradient-to-br from-red-500 to-red-600 rounded-full flex items-center justify-center shadow-lg\",children:/*#__PURE__*/_jsx(BarChart3,{className:\"w-6 h-6 text-white\"})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-white\",children:\"WKI Dealership\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-slate-400 text-sm flex items-center\",children:[/*#__PURE__*/_jsx(Calendar,{className:\"w-4 h-4 mr-1\"}),dealership.month,\" \",dealership.year]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center space-x-2\",children:/*#__PURE__*/_jsxs(\"span\",{className:\"text-slate-300 text-sm\",children:[dealership.locations.length,\" locations\"]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 md:grid-cols-4 gap-4\",children:[dealership.metrics.dwellTime&&/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-slate-400 text-sm\",children:\"Dwell Time\"}),/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold text-blue-400\",children:dealership.metrics.dwellTime})]}),dealership.metrics.triageTime&&/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-slate-400 text-sm\",children:\"Triage Time\"}),/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold text-blue-400\",children:dealership.metrics.triageTime})]}),dealership.metrics.customerSatisfaction&&/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-slate-400 text-sm\",children:\"Customer Satisfaction\"}),/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold \".concat((typeof dealership.metrics.customerSatisfaction==='string'&&dealership.metrics.customerSatisfaction.includes('%')?parseFloat(dealership.metrics.customerSatisfaction.replace('%',''))<90:typeof dealership.metrics.customerSatisfaction==='number'&&dealership.metrics.customerSatisfaction<90)?'text-red-400':'text-green-400'),children:dealership.metrics.customerSatisfaction})]}),dealership.metrics.serviceEfficiency&&/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-slate-400 text-sm\",children:\"Service Efficiency\"}),/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold text-blue-400\",children:dealership.metrics.serviceEfficiency})]}),dealership.metrics.totalCases&&/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-slate-400 text-sm\",children:\"Total Cases\"}),/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold text-blue-400\",children:dealership.metrics.totalCases})]}),dealership.metrics.completedCases&&/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-slate-400 text-sm\",children:\"Completed Cases\"}),/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold text-green-400\",children:dealership.metrics.completedCases})]})]})]},dealership.id))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gradient-to-br from-slate-800 via-slate-900 to-slate-800 rounded-2xl p-8 border border-slate-700 shadow-2xl\",children:[/*#__PURE__*/_jsxs(\"h2\",{className:\"text-2xl font-bold text-white mb-6 flex items-center\",children:[/*#__PURE__*/_jsx(MapPin,{className:\"w-6 h-6 mr-2 text-red-400\"}),\"Location Performance Details (\",scorecards.length,\")\"]}),scorecards.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-12\",children:[/*#__PURE__*/_jsx(FileText,{className:\"w-16 h-16 text-slate-600 mx-auto mb-4\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-slate-400 text-lg\",children:\"No scorecards uploaded yet\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-slate-500 text-sm\",children:\"Upload your first monthly scorecard to get started\"})]}):/*#__PURE__*/_jsx(\"div\",{className:\"grid gap-4\",children:scorecards.map(scorecard=>/*#__PURE__*/_jsxs(\"div\",{className:\"bg-slate-800/50 rounded-lg p-6 border border-slate-700\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-12 h-12 bg-gradient-to-br \".concat(getLocationColor(scorecard.locationId),\" rounded-full flex items-center justify-center shadow-lg\"),children:/*#__PURE__*/_jsx(MapPin,{className:\"w-6 h-6 text-white\"})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-white\",children:scorecard.location}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-slate-400 text-sm flex items-center\",children:[/*#__PURE__*/_jsx(Calendar,{className:\"w-4 h-4 mr-1\"}),scorecard.month,\" \",scorecard.year]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"flex items-center text-green-400 text-sm\",children:[/*#__PURE__*/_jsx(CheckCircle,{className:\"w-4 h-4 mr-1\"}),\"Active Data\"]}),/*#__PURE__*/_jsx(Link,{to:\"/location-metrics?location=\".concat(scorecard.locationId,\"&month=\").concat(scorecard.month,\"&year=\").concat(scorecard.year),className:\"p-2 text-slate-400 hover:text-blue-400 hover:bg-blue-400/10 rounded-lg transition-colors\",title:\"View in Dashboard\",children:/*#__PURE__*/_jsx(Eye,{className:\"w-4 h-4\"})}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>deleteScorecard(scorecard.id),className:\"p-2 text-slate-400 hover:text-red-400 hover:bg-red-400/10 rounded-lg transition-colors\",children:/*#__PURE__*/_jsx(X,{className:\"w-4 h-4\"})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 md:grid-cols-4 gap-4\",children:[scorecard.metrics.dwellTime&&/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-slate-400 text-sm\",children:\"Dwell Time\"}),/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold text-blue-400\",children:scorecard.metrics.dwellTime})]}),scorecard.metrics.triageTime&&/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-slate-400 text-sm\",children:\"Triage Time\"}),/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold text-blue-400\",children:scorecard.metrics.triageTime})]}),scorecard.metrics.cases&&/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-slate-400 text-sm\",children:\"Cases\"}),/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold text-blue-400\",children:scorecard.metrics.cases})]}),scorecard.metrics.customerSatisfaction&&/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-slate-400 text-sm\",children:\"Customer Satisfaction\"}),/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold \".concat(typeof scorecard.metrics.customerSatisfaction==='string'&&scorecard.metrics.customerSatisfaction.includes('%')?parseFloat(scorecard.metrics.customerSatisfaction.replace('%',''))<90?'text-red-400':'text-green-400':typeof scorecard.metrics.customerSatisfaction==='number'&&scorecard.metrics.customerSatisfaction<90?'text-red-400':'text-green-400'),children:scorecard.metrics.customerSatisfaction})]}),scorecard.metrics.etrCompliance&&/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-slate-400 text-sm\",children:\"ETR Compliance\"}),/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold \".concat((typeof scorecard.metrics.etrCompliance==='string'&&scorecard.metrics.etrCompliance.includes('%')?parseFloat(scorecard.metrics.etrCompliance.replace('%',''))<85:typeof scorecard.metrics.etrCompliance==='number'&&scorecard.metrics.etrCompliance<85)?'text-red-400':'text-green-400'),children:scorecard.metrics.etrCompliance})]}),scorecard.metrics.firstTimeFix&&/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-slate-400 text-sm\",children:\"First Time Fix\"}),/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold \".concat((typeof scorecard.metrics.firstTimeFix==='string'&&scorecard.metrics.firstTimeFix.includes('%')?parseFloat(scorecard.metrics.firstTimeFix.replace('%',''))<80:typeof scorecard.metrics.firstTimeFix==='number'&&scorecard.metrics.firstTimeFix<80)?'text-red-400':'text-green-400'),children:scorecard.metrics.firstTimeFix})]}),scorecard.metrics.partsAvailability&&/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-slate-400 text-sm\",children:\"Parts Availability\"}),/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold \".concat((typeof scorecard.metrics.partsAvailability==='string'&&scorecard.metrics.partsAvailability.includes('%')?parseFloat(scorecard.metrics.partsAvailability.replace('%',''))<85:typeof scorecard.metrics.partsAvailability==='number'&&scorecard.metrics.partsAvailability<85)?'text-red-400':'text-green-400'),children:scorecard.metrics.partsAvailability})]}),scorecard.metrics.workOrderAccuracy&&/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-slate-400 text-sm\",children:\"Work Order Accuracy\"}),/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold \".concat((typeof scorecard.metrics.workOrderAccuracy==='string'&&scorecard.metrics.workOrderAccuracy.includes('%')?parseFloat(scorecard.metrics.workOrderAccuracy.replace('%',''))<90:typeof scorecard.metrics.workOrderAccuracy==='number'&&scorecard.metrics.workOrderAccuracy<90)?'text-red-400':'text-green-400'),children:scorecard.metrics.workOrderAccuracy})]})]})]},scorecard.id))})]})]})]});}","map":{"version":3,"names":["React","useState","useRef","useEffect","Upload","FileText","MapPin","Calendar","BarChart3","AlertCircle","CheckCircle","X","Eye","Link","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","locations","id","name","code","color","API_BASE_URL","testAPIConnection","response","fetch","concat","method","console","log","status","ok","error","Error","message","String","uploadScorecardToAPI","file","month","year","formData","FormData","append","toString","apiUrl","body","errorText","text","includes","statusText","json","fetchLocationMetrics","getStoredScorecards","stored","localStorage","getItem","JSON","parse","saveStoredScorecards","scorecards","setItem","stringify","getStoredDealershipData","saveStoredDealershipData","dealershipData","ScorecardManager","setScorecards","setDealershipData","isUploading","setIsUploading","uploadProgress","setUploadProgress","selectedMonth","setSelectedMonth","selectedYear","setSelectedYear","Date","getFullYear","dragActive","setDragActive","parseError","setParseError","isLoading","setIsLoading","fileInputRef","loadData","apiWorking","backendData","dealership","extractedAt","data","dealershipScorecard","fileName","uploadDate","toISOString","metrics","locationScorecards","map","location","locationInfo","getLocationInfo","locationId","trend","calculateTrend","months","years","Array","from","length","_","i","handleFileUpload","files","alert","toLowerCase","result","Object","keys","results","isArray","errorDetails","join","setTimeout","window","dispatchEvent","CustomEvent","detail","timestamp","getTime","errorMessage","locationName","normalized","trends","Math","floor","random","handleDrag","e","preventDefault","stopPropagation","type","handleDrop","dataTransfer","deleteScorecard","prev","updated","filter","sc","getLocationName","_locations$find","find","loc","getLocationColor","_locations$find2","className","children","to","value","onChange","target","parseInt","onDragEnter","onDragLeave","onDragOver","onDrop","ref","accept","style","width","onClick","_fileInputRef$current","current","click","disabled","dwellTime","triageTime","customerSatisfaction","parseFloat","replace","serviceEfficiency","totalCases","completedCases","scorecard","title","cases","etrCompliance","firstTimeFix","partsAvailability","workOrderAccuracy"],"sources":["C:/Users/michaela/service-management-app/frontend/src/components/ScorecardManager.tsx"],"sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\r\nimport { Upload, FileText, MapPin, Calendar, BarChart3, AlertCircle, CheckCircle, X, Eye } from 'lucide-react';\r\nimport { Link } from 'react-router-dom';\r\n\r\ninterface DealershipMetrics {\r\n  dwellTime?: string;\r\n  triageTime?: string;\r\n  customerSatisfaction?: string;\r\n  serviceEfficiency?: string;\r\n  totalCases?: string;\r\n  completedCases?: string;\r\n  etrCompliance?: number;\r\n  firstTimeFix?: number;\r\n  caseCount?: number;\r\n  campaigns?: CampaignData[];\r\n}\r\n\r\ninterface LocationMetrics {\r\n  dwellTime?: string;\r\n  triageTime?: string;\r\n  cases?: string;\r\n  completedCases?: string;\r\n  customerSatisfaction?: string;\r\n  etrCompliance?: string;\r\n  firstTimeFix?: string;\r\n  partsAvailability?: string;\r\n  workOrderAccuracy?: string;\r\n  campaigns?: CampaignData[];\r\n}\r\n\r\ninterface CampaignData {\r\n  id: string;\r\n  name: string;\r\n  locationScore: number;\r\n  nationalScore: number;\r\n  goal: number;\r\n}\r\n\r\ninterface DealershipScorecard {\r\n  id: string;\r\n  month: string;\r\n  year: number;\r\n  fileName: string;\r\n  uploadDate: Date;\r\n  metrics: DealershipMetrics;\r\n  locations: LocationScorecard[];\r\n}\r\ninterface LocationScorecard {\r\n  id: string;\r\n  location: string;\r\n  locationId: string;\r\n  month: string;\r\n  year: number;\r\n  fileName: string;\r\n  uploadDate: Date;\r\n  metrics: LocationMetrics;\r\n  trend: 'up' | 'down' | 'stable';\r\n}\r\n\r\nconst locations = [\r\n  { id: 'wichita', name: 'Wichita Kenworth', code: 'WIC', color: 'from-blue-500 to-blue-600' },\r\n  { id: 'emporia', name: 'Emporia Kenworth', code: 'EMP', color: 'from-green-500 to-green-600' },\r\n  { id: 'dodge-city', name: 'Dodge City Kenworth', code: 'DOD', color: 'from-purple-500 to-purple-600' },\r\n  { id: 'liberal', name: 'Liberal Kenworth', code: 'LIB', color: 'from-orange-500 to-orange-600' }\r\n];\r\n\r\n// Backend API base URL\r\nconst API_BASE_URL = 'https://wki-service-management-app.onrender.com';\r\n\r\n// Test API connection\r\nconst testAPIConnection = async () => {\r\n  try {\r\n    // Test the main endpoint we'll be using\r\n    const response = await fetch(`${API_BASE_URL}/api/locationMetrics/upload`, {\r\n      method: 'GET', // Just test connectivity, not actual upload\r\n    });\r\n    console.log('Backend connectivity test:', response.status);\r\n    \r\n    if (response.status === 405) {\r\n      // Method not allowed is expected for GET on upload endpoint\r\n      console.log('✅ Backend is responding (POST endpoint ready)');\r\n      return true;\r\n    } else if (response.status === 500) {\r\n      console.log('⚠️ Backend responding but has server errors (likely database issue)');\r\n      return true; // Backend is running, just has DB issues\r\n    }\r\n    \r\n    return response.ok;\r\n  } catch (error) {\r\n    console.error('Backend connectivity test failed:', error instanceof Error ? error.message : String(error));\r\n    return false;\r\n  }\r\n};\r\n\r\n// API functions\r\nconst uploadScorecardToAPI = async (file: File, month: string, year: number) => {\r\n  const formData = new FormData();\r\n  formData.append('pdf', file); // Match your backend's expected field name\r\n  formData.append('month', month);\r\n  formData.append('year', year.toString());\r\n\r\n  // We found the correct endpoint: /api/locationMetrics/upload\r\n  const apiUrl = `${API_BASE_URL}/api/locationMetrics/upload`;\r\n  console.log('Uploading to:', apiUrl);\r\n\r\n  const response = await fetch(apiUrl, {\r\n    method: 'POST',\r\n    body: formData,\r\n  });\r\n\r\n  if (!response.ok) {\r\n    const errorText = await response.text();\r\n    console.error('Upload failed:', response.status, errorText);\r\n    \r\n    // Handle specific backend errors\r\n    if (response.status === 500 && errorText.includes('buffering timed out')) {\r\n      throw new Error('Database connection timeout. Please try again in a moment - the backend database may be starting up.');\r\n    } else if (response.status === 500) {\r\n      throw new Error('Server error. Please check backend logs for details.');\r\n    }\r\n    \r\n    throw new Error(`Upload failed: ${response.status} ${response.statusText} - ${errorText}`);\r\n  }\r\n\r\n  return response.json();\r\n};\r\n\r\nconst fetchLocationMetrics = async () => {\r\n  const response = await fetch(`${API_BASE_URL}/api/locationMetrics`);\r\n  if (!response.ok) {\r\n    throw new Error(`Failed to fetch metrics: ${response.statusText}`);\r\n  }\r\n  return response.json();\r\n};\r\n\r\n// This would be replaced with actual localStorage or database storage\r\nconst getStoredScorecards = (): LocationScorecard[] => {\r\n  const stored = localStorage.getItem('wki-scorecards');\r\n  return stored ? JSON.parse(stored) : [];\r\n};\r\n\r\nconst saveStoredScorecards = (scorecards: LocationScorecard[]) => {\r\n  localStorage.setItem('wki-scorecards', JSON.stringify(scorecards));\r\n};\r\n\r\nconst getStoredDealershipData = (): DealershipScorecard[] => {\r\n  const stored = localStorage.getItem('wki-dealership-scorecards');\r\n  return stored ? JSON.parse(stored) : [];\r\n};\r\n\r\nconst saveStoredDealershipData = (dealershipData: DealershipScorecard[]) => {\r\n  localStorage.setItem('wki-dealership-scorecards', JSON.stringify(dealershipData));\r\n};\r\n\r\nexport default function ScorecardManager() {\r\n  const [scorecards, setScorecards] = useState<LocationScorecard[]>([]);\r\n  const [dealershipData, setDealershipData] = useState<DealershipScorecard[]>([]);\r\n  const [isUploading, setIsUploading] = useState(false);\r\n  const [uploadProgress, setUploadProgress] = useState(0);\r\n  const [selectedMonth, setSelectedMonth] = useState('');\r\n  const [selectedYear, setSelectedYear] = useState(new Date().getFullYear());\r\n  const [dragActive, setDragActive] = useState(false);\r\n  const [parseError, setParseError] = useState<string | null>(null);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const fileInputRef = useRef<HTMLInputElement>(null);\r\n\r\n  // Always load data from backend on mount, fallback to localStorage if backend fails\r\n  useEffect(() => {\r\n    const loadData = async () => {\r\n      try {\r\n        // Test API connection\r\n        const apiWorking = await testAPIConnection();\r\n        console.log('API connection test result:', apiWorking);\r\n        // Always try to fetch from backend\r\n        const backendData = await fetchLocationMetrics();\r\n        // Parse backendData for dealership and locations\r\n        let dealership: DealershipMetrics | undefined, locations: any[] | undefined, extractedAt: string | undefined;\r\n        if (backendData && typeof backendData === 'object') {\r\n          if ('dealership' in backendData && 'locations' in backendData) {\r\n            ({ dealership, locations, extractedAt } = backendData);\r\n          } else if ('data' in backendData && backendData.data && typeof backendData.data === 'object') {\r\n            if ('dealership' in backendData.data && 'locations' in backendData.data) {\r\n              ({ dealership, locations, extractedAt } = backendData.data);\r\n            }\r\n          }\r\n        }\r\n        if (dealership && locations) {\r\n          // Build scorecards from backend\r\n          const dealershipScorecard: DealershipScorecard = {\r\n            id: `dealership-latest`,\r\n            month: '',\r\n            year: 0,\r\n            fileName: '',\r\n            uploadDate: new Date(extractedAt || new Date().toISOString()),\r\n            metrics: dealership,\r\n            locations: []\r\n          };\r\n          const locationScorecards: LocationScorecard[] = locations.map((location: any) => {\r\n            const locationInfo = getLocationInfo(location.name);\r\n            return {\r\n              id: `${locationInfo.id}-latest`,\r\n              location: location.name,\r\n              locationId: locationInfo.id,\r\n              month: '',\r\n              year: 0,\r\n              fileName: '',\r\n              uploadDate: new Date(extractedAt || new Date().toISOString()),\r\n              metrics: location,\r\n              trend: calculateTrend()\r\n            };\r\n          });\r\n          dealershipScorecard.locations = locationScorecards;\r\n          setDealershipData([dealershipScorecard]);\r\n          setScorecards(locationScorecards);\r\n        } else {\r\n          setScorecards([]);\r\n          setDealershipData([]);\r\n        }\r\n      } catch (error) {\r\n        // Fallback to localStorage if backend fails\r\n        console.error('Error loading data from backend, using localStorage fallback:', error);\r\n        setScorecards(getStoredScorecards());\r\n        setDealershipData(getStoredDealershipData());\r\n      } finally {\r\n        setIsLoading(false);\r\n      }\r\n    };\r\n    loadData();\r\n  }, []);\r\n\r\n  // Generate months for dropdown\r\n  const months = [\r\n    'January', 'February', 'March', 'April', 'May', 'June',\r\n    'July', 'August', 'September', 'October', 'November', 'December'\r\n  ];\r\n\r\n  // Generate years (current year and 2 previous years)\r\n  const years = Array.from({ length: 3 }, (_, i) => new Date().getFullYear() - i);\r\n\r\n  const handleFileUpload = async (files: FileList | null) => {\r\n    if (!files || files.length === 0) return;\r\n    if (!selectedMonth) {\r\n      alert('Please select a month before uploading');\r\n      return;\r\n    }\r\n\r\n    const file = files[0];\r\n    if (!file.name.toLowerCase().includes('.pdf')) {\r\n      alert('Please upload a PDF file');\r\n      return;\r\n    }\r\n\r\n    setIsUploading(true);\r\n    setUploadProgress(0);\r\n    setParseError(null);\r\n\r\n    try {\r\n      // Upload to backend API\r\n      setUploadProgress(20);\r\n      console.log('Starting upload process...');\r\n      \r\n      const result = await uploadScorecardToAPI(file, selectedMonth, selectedYear);\r\n      console.log('Upload successful, result:', result);\r\n      setUploadProgress(60);\r\n\r\n      // DEBUGGING BLOCK - Add this to see what the backend is actually returning\r\n      console.log('=== DEBUGGING RESPONSE STRUCTURE ===');\r\n      console.log('Type of result:', typeof result);\r\n      console.log('Result keys:', Object.keys(result || {}));\r\n      console.log('Full result structure:', JSON.stringify(result, null, 2));\r\n\r\n      // Check specific properties\r\n      console.log('Has dealership?', 'dealership' in (result || {}));\r\n      console.log('Has locations?', 'locations' in (result || {}));\r\n      console.log('Has data?', 'data' in (result || {}));\r\n\r\n      if (result && typeof result === 'object' && 'data' in result) {\r\n        console.log('Data structure:', JSON.stringify(result.data, null, 2));\r\n        console.log('Data keys:', Object.keys(result.data || {}));\r\n      }\r\n      console.log('=== END DEBUG ===');\r\n\r\n      // Process the returned data from your backend with flexible parsing\r\n      console.log('Processing result structure:', result);\r\n\r\n      let dealership: DealershipMetrics | undefined, locations: any[] | undefined, extractedAt: string | undefined;\r\n\r\n      if (result && typeof result === 'object') {\r\n        // Pattern 1: Direct structure { dealership, locations, extractedAt }\r\n        if ('dealership' in result && 'locations' in result) {\r\n          ({ dealership, locations, extractedAt } = result);\r\n          console.log('✅ Using Pattern 1: Direct structure');\r\n        }\r\n        // Pattern 2: Nested in data { success, data: { dealership, locations } }\r\n        else if ('data' in result && result.data && typeof result.data === 'object') {\r\n          if ('dealership' in result.data && 'locations' in result.data) {\r\n            ({ dealership, locations, extractedAt } = result.data);\r\n            console.log('✅ Using Pattern 2: Nested in data');\r\n          }\r\n        }\r\n        // Pattern 3: Success wrapper { success: true, dealership, locations }\r\n        else if ('success' in result && 'dealership' in result && 'locations' in result) {\r\n          ({ dealership, locations, extractedAt } = result);\r\n          console.log('✅ Using Pattern 3: Success wrapper');\r\n        }\r\n        // Pattern 4: Results wrapper { results: { dealership, locations } }\r\n        else if ('results' in result && result.results && typeof result.results === 'object') {\r\n          if ('dealership' in result.results && 'locations' in result.results) {\r\n            ({ dealership, locations, extractedAt } = result.results);\r\n            console.log('✅ Using Pattern 4: Results wrapper');\r\n          }\r\n        }\r\n        // Pattern 5: Message with data { message: \"success\", data: {...} }\r\n        else if ('message' in result && 'data' in result && result.data) {\r\n          if (typeof result.data === 'object' && 'dealership' in result.data && 'locations' in result.data) {\r\n            ({ dealership, locations, extractedAt } = result.data);\r\n            console.log('✅ Using Pattern 5: Message with data');\r\n          }\r\n        }\r\n        // Pattern 6: Check if the result itself contains arrays/objects that might be locations\r\n        else if (Array.isArray(result)) {\r\n          console.log('⚠️  Response is an array, might be locations directly');\r\n          locations = result;\r\n          // You might need to extract dealership data differently\r\n        }\r\n        else {\r\n          console.error('❌ Unknown response pattern. Available keys:', Object.keys(result));\r\n          console.error('Full response:', JSON.stringify(result, null, 2));\r\n        }\r\n      }\r\n\r\n      // More detailed error handling\r\n      if (!dealership && !locations) {\r\n        const errorDetails = `\r\nResponse Analysis:\r\n- Type: ${typeof result}\r\n- Keys: ${result && typeof result === 'object' ? Object.keys(result).join(', ') : 'N/A'}\r\n- Structure: ${JSON.stringify(result, null, 2)}\r\n\r\nExpected one of these structures:\r\n1. { dealership: {...}, locations: [...] }\r\n2. { data: { dealership: {...}, locations: [...] } }\r\n3. { success: true, dealership: {...}, locations: [...] }\r\n4. { results: { dealership: {...}, locations: [...] } }\r\n5. { message: \"...\", data: { dealership: {...}, locations: [...] } }\r\n        `;\r\n        \r\n        throw new Error(`Invalid response structure from backend. ${errorDetails}`);\r\n      } else if (!dealership) {\r\n        throw new Error(`Missing dealership data in response. Available: ${locations ? 'locations' : 'none'}`);\r\n      } else if (!locations) {\r\n        throw new Error(`Missing locations data in response. Available: ${dealership ? 'dealership' : 'none'}`);\r\n      }\r\n\r\n      // Create dealership scorecard from backend response\r\n      const dealershipScorecard: DealershipScorecard = {\r\n        id: `dealership-${selectedMonth}-${selectedYear}`,\r\n        month: selectedMonth,\r\n        year: selectedYear,\r\n        fileName: file.name,\r\n        uploadDate: new Date(extractedAt || new Date().toISOString()),\r\n        metrics: dealership,\r\n        locations: []\r\n      };\r\n\r\n      // Create location scorecards from backend response\r\n      const locationScorecards: LocationScorecard[] = locations.map((location: any) => {\r\n        const locationInfo = getLocationInfo(location.name);\r\n        return {\r\n          id: `${locationInfo.id}-${selectedMonth}-${selectedYear}`,\r\n          location: location.name,\r\n          locationId: locationInfo.id,\r\n          month: selectedMonth,\r\n          year: selectedYear,\r\n          fileName: file.name,\r\n          uploadDate: new Date(extractedAt || new Date().toISOString()),\r\n          metrics: location,\r\n          trend: calculateTrend() // Random trend for now\r\n        };\r\n      });\r\n\r\n      dealershipScorecard.locations = locationScorecards;\r\n      setUploadProgress(90);\r\n\r\n      // After upload, always fetch latest from backend and update UI\r\n      setUploadProgress(100);\r\n      try {\r\n        const backendData = await fetchLocationMetrics();\r\n        let dealership: DealershipMetrics | undefined, locations: any[] | undefined, extractedAt: string | undefined;\r\n        if (backendData && typeof backendData === 'object') {\r\n          if ('dealership' in backendData && 'locations' in backendData) {\r\n            ({ dealership, locations, extractedAt } = backendData);\r\n          } else if ('data' in backendData && backendData.data && typeof backendData.data === 'object') {\r\n            if ('dealership' in backendData.data && 'locations' in backendData.data) {\r\n              ({ dealership, locations, extractedAt } = backendData.data);\r\n            }\r\n          }\r\n        }\r\n        if (dealership && locations) {\r\n          const dealershipScorecard: DealershipScorecard = {\r\n            id: `dealership-latest`,\r\n            month: '',\r\n            year: 0,\r\n            fileName: '',\r\n            uploadDate: new Date(extractedAt || new Date().toISOString()),\r\n            metrics: dealership,\r\n            locations: []\r\n          };\r\n          const locationScorecards: LocationScorecard[] = locations.map((location: any) => {\r\n            const locationInfo = getLocationInfo(location.name);\r\n            return {\r\n              id: `${locationInfo.id}-latest`,\r\n              location: location.name,\r\n              locationId: locationInfo.id,\r\n              month: '',\r\n              year: 0,\r\n              fileName: '',\r\n              uploadDate: new Date(extractedAt || new Date().toISOString()),\r\n              metrics: location,\r\n              trend: calculateTrend()\r\n            };\r\n          });\r\n          dealershipScorecard.locations = locationScorecards;\r\n          setDealershipData([dealershipScorecard]);\r\n          setScorecards(locationScorecards);\r\n        } else {\r\n          setScorecards([]);\r\n          setDealershipData([]);\r\n        }\r\n      } catch (error) {\r\n        // Fallback to localStorage if backend fails\r\n        console.error('Error fetching after upload, using localStorage fallback:', error);\r\n        setScorecards(getStoredScorecards());\r\n        setDealershipData(getStoredDealershipData());\r\n      }\r\n      setTimeout(() => {\r\n        setIsUploading(false);\r\n        setUploadProgress(0);\r\n        \r\n        // Dispatch custom event to notify other components about new data\r\n        window.dispatchEvent(new CustomEvent('scorecardUploaded', { \r\n          detail: { \r\n            dealership, \r\n            locations, \r\n            extractedAt,\r\n            timestamp: new Date().getTime()\r\n          } \r\n        }));\r\n        \r\n        alert(`Successfully uploaded and processed ${file.name}!\\n\\nExtracted data for:\\n- WKI Dealership\\n- ${(locations ? locations.length : 0)} locations`);\r\n      }, 500);\r\n\r\n    } catch (error) {\r\n      console.error('Error uploading PDF:', error);\r\n      const errorMessage = error instanceof Error ? error.message : 'Failed to process PDF. Please try again.';\r\n      console.error('Detailed error:', errorMessage);\r\n      setParseError(errorMessage);\r\n      setIsUploading(false);\r\n      setUploadProgress(0);\r\n    }\r\n  };\r\n\r\n  // Helper function to get location info by name\r\n  const getLocationInfo = (locationName: string) => {\r\n    const normalized = locationName.toLowerCase();\r\n    if (normalized.includes('wichita')) return locations[0];\r\n    if (normalized.includes('emporia')) return locations[1];\r\n    if (normalized.includes('dodge')) return locations[2];\r\n    if (normalized.includes('liberal')) return locations[3];\r\n    return { id: 'unknown', name: locationName, code: 'UNK', color: 'from-gray-500 to-gray-600' };\r\n  };\r\n\r\n  // Helper function to calculate trend\r\n  const calculateTrend = (): 'up' | 'down' | 'stable' => {\r\n    // Random trend for now - in real implementation, compare with previous month\r\n    const trends: ('up' | 'down' | 'stable')[] = ['up', 'down', 'stable'];\r\n    return trends[Math.floor(Math.random() * trends.length)];\r\n  };\r\n\r\n  const handleDrag = (e: React.DragEvent) => {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    if (e.type === 'dragenter' || e.type === 'dragover') {\r\n      setDragActive(true);\r\n    } else if (e.type === 'dragleave') {\r\n      setDragActive(false);\r\n    }\r\n  };\r\n\r\n  const handleDrop = (e: React.DragEvent) => {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    setDragActive(false);\r\n    handleFileUpload(e.dataTransfer.files);\r\n  };\r\n\r\n  const deleteScorecard = (id: string) => {\r\n    setScorecards(prev => {\r\n      const updated = prev.filter(sc => sc.id !== id);\r\n      saveStoredScorecards(updated); // Save to localStorage\r\n      return updated;\r\n    });\r\n  };\r\n\r\n  const getLocationName = (locationId: string) => {\r\n    return locations.find(loc => loc.id === locationId)?.name || locationId;\r\n  };\r\n\r\n  const getLocationColor = (locationId: string) => {\r\n    return locations.find(loc => loc.id === locationId)?.color || 'from-slate-500 to-slate-600';\r\n  };\r\n\r\n  return (\r\n    <div className=\"max-w-7xl mx-auto px-4 py-8\">\r\n      <div className=\"text-center mb-8\">\r\n        <h1 className=\"text-4xl font-bold bg-gradient-to-r from-red-600 to-red-700 bg-clip-text text-transparent mb-4\">\r\n          Monthly Service Scorecard Manager\r\n        </h1>\r\n        <p className=\"text-xl text-slate-300 mb-4\">\r\n          Upload and manage monthly W370 Service Scorecards for all WKI locations\r\n        </p>\r\n        <div className=\"flex justify-center\">\r\n          <Link \r\n            to=\"/location-metrics\"\r\n            className=\"inline-flex items-center px-6 py-3 bg-gradient-to-r from-purple-600 to-purple-700 text-white font-medium rounded-lg hover:from-purple-700 hover:to-purple-800 transition-all duration-200 shadow-lg hover:shadow-purple-500/25\"\r\n          >\r\n            <Eye className=\"w-5 h-5 mr-2\" />\r\n            View Location Performance Dashboard\r\n          </Link>\r\n        </div>\r\n      </div>\r\n\r\n      {isLoading ? (\r\n        <div className=\"flex items-center justify-center py-12\">\r\n          <div className=\"animate-spin w-12 h-12 border-4 border-red-500 border-t-transparent rounded-full\"></div>\r\n          <p className=\"text-slate-300 ml-4\">Loading scorecard data...</p>\r\n        </div>\r\n      ) : (\r\n        <>\r\n          {/* Upload Section */}\r\n          <div className=\"bg-gradient-to-br from-slate-800 via-slate-900 to-slate-800 rounded-2xl p-8 mb-8 border border-slate-700 shadow-2xl\">\r\n        <h2 className=\"text-2xl font-bold text-white mb-6 flex items-center\">\r\n          <Upload className=\"w-6 h-6 mr-2 text-red-400\" />\r\n          Upload New Scorecard\r\n        </h2>\r\n\r\n        {/* Date Selection */}\r\n        <div className=\"grid md:grid-cols-2 gap-4 mb-6\">\r\n          <div>\r\n            <label className=\"block text-sm font-medium text-slate-300 mb-2\">Month</label>\r\n            <select\r\n              value={selectedMonth}\r\n              onChange={(e) => setSelectedMonth(e.target.value)}\r\n              className=\"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-red-500 focus:border-transparent\"\r\n            >\r\n              <option value=\"\">Select Month</option>\r\n              {months.map(month => (\r\n                <option key={month} value={month}>{month}</option>\r\n              ))}\r\n            </select>\r\n          </div>\r\n          <div>\r\n            <label className=\"block text-sm font-medium text-slate-300 mb-2\">Year</label>\r\n            <select\r\n              value={selectedYear}\r\n              onChange={(e) => setSelectedYear(parseInt(e.target.value))}\r\n              className=\"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-red-500 focus:border-transparent\"\r\n            >\r\n              {years.map(year => (\r\n                <option key={year} value={year}>{year}</option>\r\n              ))}\r\n            </select>\r\n          </div>\r\n        </div>\r\n\r\n        {/* File Upload Area */}\r\n        <div\r\n          className={`border-2 border-dashed rounded-lg p-8 text-center transition-colors ${\r\n            dragActive\r\n              ? 'border-red-400 bg-red-400/10'\r\n              : 'border-slate-600 hover:border-red-400 hover:bg-red-400/5'\r\n          }`}\r\n          onDragEnter={handleDrag}\r\n          onDragLeave={handleDrag}\r\n          onDragOver={handleDrag}\r\n          onDrop={handleDrop}\r\n        >\r\n          <input\r\n            ref={fileInputRef}\r\n            type=\"file\"\r\n            accept=\".pdf\"\r\n            onChange={(e) => handleFileUpload(e.target.files)}\r\n            className=\"hidden\"\r\n          />\r\n          \r\n          {isUploading ? (\r\n            <div className=\"space-y-4\">\r\n              <div className=\"animate-spin w-12 h-12 border-4 border-red-500 border-t-transparent rounded-full mx-auto\"></div>\r\n              <p className=\"text-slate-300\">Processing scorecard...</p>\r\n              <div className=\"w-full bg-slate-700 rounded-full h-2\">\r\n                <div \r\n                  className=\"bg-red-500 h-2 rounded-full transition-all duration-300\"\r\n                  style={{ width: `${uploadProgress}%` }}\r\n                ></div>\r\n              </div>\r\n            </div>\r\n          ) : (\r\n            <div className=\"space-y-4\">\r\n              <FileText className=\"w-16 h-16 text-slate-400 mx-auto\" />\r\n              <div>\r\n                <p className=\"text-white font-medium mb-2\">Drop your WKI Service Scorecard PDF here or click to browse</p>\r\n                <p className=\"text-slate-400 text-sm\">Supports W370 Service Scorecard PDFs up to 10MB</p>\r\n              </div>\r\n              <div className=\"flex flex-col sm:flex-row justify-center items-center gap-4\">\r\n                <button\r\n                  onClick={() => fileInputRef.current?.click()}\r\n                  disabled={!selectedMonth}\r\n                  className={`px-8 py-4 font-bold rounded-lg transition-all duration-200 transform hover:scale-105 shadow-lg ${\r\n                    !selectedMonth\r\n                      ? 'bg-slate-600 text-slate-400 cursor-not-allowed'\r\n                      : 'bg-gradient-to-r from-red-600 to-red-700 text-white hover:from-red-700 hover:to-red-800 hover:shadow-red-500/25'\r\n                  }`}\r\n                >\r\n                  <Upload className=\"w-5 h-5 mr-2 inline\" />\r\n                  Choose Scorecard PDF\r\n                </button>\r\n                {!selectedMonth && (\r\n                  <div className=\"text-yellow-400 text-sm flex items-center\">\r\n                    <AlertCircle className=\"w-4 h-4 mr-1\" />\r\n                    Please select month first\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Parse Error Display */}\r\n        {parseError && (\r\n          <div className=\"mt-4 p-4 bg-red-900/50 border border-red-600 rounded-lg\">\r\n            <div className=\"flex items-center text-red-300 mb-2\">\r\n              <AlertCircle className=\"w-5 h-5 mr-2\" />\r\n              <span className=\"font-medium\">Upload Error</span>\r\n            </div>\r\n            <p className=\"text-red-200 text-sm mb-2\">{parseError}</p>\r\n            {parseError.includes('Database connection timeout') && (\r\n              <div className=\"mt-3 p-3 bg-yellow-900/30 border border-yellow-600 rounded\">\r\n                <p className=\"text-yellow-200 text-sm\">\r\n                  <strong>Tip:</strong> This usually happens when the backend database is starting up. \r\n                  Wait 30-60 seconds and try uploading again.\r\n                </p>\r\n              </div>\r\n            )}\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Dealership Summary */}\r\n      {dealershipData.length > 0 && (\r\n        <div className=\"bg-gradient-to-br from-slate-800 via-slate-900 to-slate-800 rounded-2xl p-8 mb-8 border border-slate-700 shadow-2xl\">\r\n          <h2 className=\"text-2xl font-bold text-white mb-6 flex items-center\">\r\n            <BarChart3 className=\"w-6 h-6 mr-2 text-red-400\" />\r\n            Dealership Performance Summary\r\n          </h2>\r\n          <div className=\"grid gap-4\">\r\n            {dealershipData.map((dealership) => (\r\n              <div key={dealership.id} className=\"bg-slate-800/50 rounded-lg p-6 border border-slate-700\">\r\n                <div className=\"flex items-center justify-between mb-4\">\r\n                  <div className=\"flex items-center space-x-3\">\r\n                    <div className=\"w-12 h-12 bg-gradient-to-br from-red-500 to-red-600 rounded-full flex items-center justify-center shadow-lg\">\r\n                      <BarChart3 className=\"w-6 h-6 text-white\" />\r\n                    </div>\r\n                    <div>\r\n                      <h3 className=\"text-lg font-semibold text-white\">\r\n                        WKI Dealership\r\n                      </h3>\r\n                      <p className=\"text-slate-400 text-sm flex items-center\">\r\n                        <Calendar className=\"w-4 h-4 mr-1\" />\r\n                        {dealership.month} {dealership.year}\r\n                      </p>\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"flex items-center space-x-2\">\r\n                    <span className=\"text-slate-300 text-sm\">\r\n                      {dealership.locations.length} locations\r\n                    </span>\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Dealership Metrics Preview */}\r\n                <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\r\n                  {dealership.metrics.dwellTime && (\r\n                    <div className=\"text-center\">\r\n                      <p className=\"text-slate-400 text-sm\">Dwell Time</p>\r\n                      <p className=\"font-semibold text-blue-400\">\r\n                        {dealership.metrics.dwellTime}\r\n                      </p>\r\n                    </div>\r\n                  )}\r\n                  {dealership.metrics.triageTime && (\r\n                    <div className=\"text-center\">\r\n                      <p className=\"text-slate-400 text-sm\">Triage Time</p>\r\n                      <p className=\"font-semibold text-blue-400\">\r\n                        {dealership.metrics.triageTime}\r\n                      </p>\r\n                    </div>\r\n                  )}\r\n                  {dealership.metrics.customerSatisfaction && (\r\n                    <div className=\"text-center\">\r\n                      <p className=\"text-slate-400 text-sm\">Customer Satisfaction</p>\r\n                      <p className={`font-semibold ${\r\n                        (typeof dealership.metrics.customerSatisfaction === 'string' && dealership.metrics.customerSatisfaction.includes('%') \r\n                          ? parseFloat(dealership.metrics.customerSatisfaction.replace('%', '')) < 90\r\n                          : typeof dealership.metrics.customerSatisfaction === 'number' && dealership.metrics.customerSatisfaction < 90\r\n                        ) ? 'text-red-400' : 'text-green-400'\r\n                      }`}>\r\n                        {dealership.metrics.customerSatisfaction}\r\n                      </p>\r\n                    </div>\r\n                  )}\r\n                  {dealership.metrics.serviceEfficiency && (\r\n                    <div className=\"text-center\">\r\n                      <p className=\"text-slate-400 text-sm\">Service Efficiency</p>\r\n                      <p className=\"font-semibold text-blue-400\">\r\n                        {dealership.metrics.serviceEfficiency}\r\n                      </p>\r\n                    </div>\r\n                  )}\r\n                  {dealership.metrics.totalCases && (\r\n                    <div className=\"text-center\">\r\n                      <p className=\"text-slate-400 text-sm\">Total Cases</p>\r\n                      <p className=\"font-semibold text-blue-400\">\r\n                        {dealership.metrics.totalCases}\r\n                      </p>\r\n                    </div>\r\n                  )}\r\n                  {dealership.metrics.completedCases && (\r\n                    <div className=\"text-center\">\r\n                      <p className=\"text-slate-400 text-sm\">Completed Cases</p>\r\n                      <p className=\"font-semibold text-green-400\">\r\n                        {dealership.metrics.completedCases}\r\n                      </p>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Location Scorecards */}\r\n      <div className=\"bg-gradient-to-br from-slate-800 via-slate-900 to-slate-800 rounded-2xl p-8 border border-slate-700 shadow-2xl\">\r\n        <h2 className=\"text-2xl font-bold text-white mb-6 flex items-center\">\r\n          <MapPin className=\"w-6 h-6 mr-2 text-red-400\" />\r\n          Location Performance Details ({scorecards.length})\r\n        </h2>\r\n\r\n        {scorecards.length === 0 ? (\r\n          <div className=\"text-center py-12\">\r\n            <FileText className=\"w-16 h-16 text-slate-600 mx-auto mb-4\" />\r\n            <p className=\"text-slate-400 text-lg\">No scorecards uploaded yet</p>\r\n            <p className=\"text-slate-500 text-sm\">Upload your first monthly scorecard to get started</p>\r\n          </div>\r\n        ) : (\r\n          <div className=\"grid gap-4\">\r\n            {scorecards.map((scorecard) => (\r\n              <div key={scorecard.id} className=\"bg-slate-800/50 rounded-lg p-6 border border-slate-700\">\r\n                <div className=\"flex items-center justify-between mb-4\">\r\n                  <div className=\"flex items-center space-x-3\">\r\n                    <div className={`w-12 h-12 bg-gradient-to-br ${getLocationColor(scorecard.locationId)} rounded-full flex items-center justify-center shadow-lg`}>\r\n                      <MapPin className=\"w-6 h-6 text-white\" />\r\n                    </div>\r\n                    <div>\r\n                      <h3 className=\"text-lg font-semibold text-white\">\r\n                        {scorecard.location}\r\n                      </h3>\r\n                      <p className=\"text-slate-400 text-sm flex items-center\">\r\n                        <Calendar className=\"w-4 h-4 mr-1\" />\r\n                        {scorecard.month} {scorecard.year}\r\n                      </p>\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"flex items-center space-x-2\">\r\n                    <span className=\"flex items-center text-green-400 text-sm\">\r\n                      <CheckCircle className=\"w-4 h-4 mr-1\" />\r\n                      Active Data\r\n                    </span>\r\n                    <Link\r\n                      to={`/location-metrics?location=${scorecard.locationId}&month=${scorecard.month}&year=${scorecard.year}`}\r\n                      className=\"p-2 text-slate-400 hover:text-blue-400 hover:bg-blue-400/10 rounded-lg transition-colors\"\r\n                      title=\"View in Dashboard\"\r\n                    >\r\n                      <Eye className=\"w-4 h-4\" />\r\n                    </Link>\r\n                    <button\r\n                      onClick={() => deleteScorecard(scorecard.id)}\r\n                      className=\"p-2 text-slate-400 hover:text-red-400 hover:bg-red-400/10 rounded-lg transition-colors\"\r\n                    >\r\n                      <X className=\"w-4 h-4\" />\r\n                    </button>\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Metrics Preview */}\r\n                <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\r\n                  {scorecard.metrics.dwellTime && (\r\n                    <div className=\"text-center\">\r\n                      <p className=\"text-slate-400 text-sm\">Dwell Time</p>\r\n                      <p className=\"font-semibold text-blue-400\">\r\n                        {scorecard.metrics.dwellTime}\r\n                      </p>\r\n                    </div>\r\n                  )}\r\n                  {scorecard.metrics.triageTime && (\r\n                    <div className=\"text-center\">\r\n                      <p className=\"text-slate-400 text-sm\">Triage Time</p>\r\n                      <p className=\"font-semibold text-blue-400\">\r\n                        {scorecard.metrics.triageTime}\r\n                      </p>\r\n                    </div>\r\n                  )}\r\n                  {scorecard.metrics.cases && (\r\n                    <div className=\"text-center\">\r\n                      <p className=\"text-slate-400 text-sm\">Cases</p>\r\n                      <p className=\"font-semibold text-blue-400\">\r\n                        {scorecard.metrics.cases}\r\n                      </p>\r\n                    </div>\r\n                  )}\r\n                  {scorecard.metrics.customerSatisfaction && (\r\n                    <div className=\"text-center\">\r\n                      <p className=\"text-slate-400 text-sm\">Customer Satisfaction</p>\r\n                      <p className={`font-semibold ${\r\n                        typeof scorecard.metrics.customerSatisfaction === 'string' && scorecard.metrics.customerSatisfaction.includes('%') \r\n                          ? (parseFloat(scorecard.metrics.customerSatisfaction.replace('%', '')) < 90 ? 'text-red-400' : 'text-green-400')\r\n                          : (typeof scorecard.metrics.customerSatisfaction === 'number' && scorecard.metrics.customerSatisfaction < 90 ? 'text-red-400' : 'text-green-400')\r\n                      }`}>\r\n                        {scorecard.metrics.customerSatisfaction}\r\n                      </p>\r\n                    </div>\r\n                  )}\r\n                  {scorecard.metrics.etrCompliance && (\r\n                    <div className=\"text-center\">\r\n                      <p className=\"text-slate-400 text-sm\">ETR Compliance</p>\r\n                      <p className={`font-semibold ${\r\n                        (typeof scorecard.metrics.etrCompliance === 'string' && scorecard.metrics.etrCompliance.includes('%') \r\n                          ? parseFloat(scorecard.metrics.etrCompliance.replace('%', '')) < 85\r\n                          : typeof scorecard.metrics.etrCompliance === 'number' && scorecard.metrics.etrCompliance < 85\r\n                        ) ? 'text-red-400' : 'text-green-400'\r\n                      }`}>\r\n                        {scorecard.metrics.etrCompliance}\r\n                      </p>\r\n                    </div>\r\n                  )}\r\n                  {scorecard.metrics.firstTimeFix && (\r\n                    <div className=\"text-center\">\r\n                      <p className=\"text-slate-400 text-sm\">First Time Fix</p>\r\n                      <p className={`font-semibold ${\r\n                        (typeof scorecard.metrics.firstTimeFix === 'string' && scorecard.metrics.firstTimeFix.includes('%') \r\n                          ? parseFloat(scorecard.metrics.firstTimeFix.replace('%', '')) < 80\r\n                          : typeof scorecard.metrics.firstTimeFix === 'number' && scorecard.metrics.firstTimeFix < 80\r\n                        ) ? 'text-red-400' : 'text-green-400'\r\n                      }`}>\r\n                        {scorecard.metrics.firstTimeFix}\r\n                      </p>\r\n                    </div>\r\n                  )}\r\n                  {scorecard.metrics.partsAvailability && (\r\n                    <div className=\"text-center\">\r\n                      <p className=\"text-slate-400 text-sm\">Parts Availability</p>\r\n                      <p className={`font-semibold ${\r\n                        (typeof scorecard.metrics.partsAvailability === 'string' && scorecard.metrics.partsAvailability.includes('%') \r\n                          ? parseFloat(scorecard.metrics.partsAvailability.replace('%', '')) < 85\r\n                          : typeof scorecard.metrics.partsAvailability === 'number' && scorecard.metrics.partsAvailability < 85\r\n                        ) ? 'text-red-400' : 'text-green-400'\r\n                      }`}>\r\n                        {scorecard.metrics.partsAvailability}\r\n                      </p>\r\n                    </div>\r\n                  )}\r\n                  {scorecard.metrics.workOrderAccuracy && (\r\n                    <div className=\"text-center\">\r\n                      <p className=\"text-slate-400 text-sm\">Work Order Accuracy</p>\r\n                      <p className={`font-semibold ${\r\n                        (typeof scorecard.metrics.workOrderAccuracy === 'string' && scorecard.metrics.workOrderAccuracy.includes('%') \r\n                          ? parseFloat(scorecard.metrics.workOrderAccuracy.replace('%', '')) < 90\r\n                          : typeof scorecard.metrics.workOrderAccuracy === 'number' && scorecard.metrics.workOrderAccuracy < 90\r\n                        ) ? 'text-red-400' : 'text-green-400'\r\n                      }`}>\r\n                        {scorecard.metrics.workOrderAccuracy}\r\n                      </p>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        )}\r\n      </div>\r\n        </>\r\n      )}\r\n    </div>\r\n  );\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}